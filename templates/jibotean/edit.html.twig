<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EditeazÄƒ Pagina - Admin</title>
    <link rel="stylesheet" href="{{ asset('css/JDV_edit.css') }}">
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <h1>âš™ï¸ EditeazÄƒ Pagina</h1>
            <p>Panoul de administrare pentru gestionarea conÈ›inutului</p>
        </div>
        
        <div class="admin-content">
            {% for message in app.flashes('success') %}
                <div class="flash-success">âœ… {{ message }}</div>
            {% endfor %}

            <!-- Editarea secÈ›iunii "Despre Mine" -->
            <div class="section-edit">
                <h2 class="section-title">ğŸ“ EditeazÄƒ secÈ›iunea "Despre Mine"</h2>
                
                <form method="post">
                    <input type="hidden" name="action" value="update_content">
                    
                    <div class="form-group">
                        <label for="about_content">ConÈ›inutul paragrafelor:</label>
                        <textarea id="about_content" name="about_content" required>{{ aboutContent ? aboutContent.content : '' }}</textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">ğŸ’¾ SalveazÄƒ conÈ›inutul</button>
                </form>
            </div>

            <!-- Editarea competenÈ›elor -->
            <div class="section-edit">
                <h2 class="section-title">ğŸ› ï¸ GestioneazÄƒ competenÈ›ele</h2>
                
                <!-- CompetenÈ›ele existente -->
                <div class="skills-editor">
                    <h4>CompetenÈ›ele existente:</h4>
                    <form method="post">
                        <input type="hidden" name="action" value="update_skills">
                        
                        {% for skill in skills %}
                            <div class="skill-item-edit">
                                <input type="text" name="skills[{{ skill.id }}]" value="{{ skill.name }}" class="skill-input" required>
                                <button type="button" onclick="deleteSkill({{ skill.id }})" class="btn btn-danger">ğŸ—‘ï¸ È˜terge</button>
                            </div>
                        {% endfor %}
                        
                        {% if skills is not empty %}
                            <button type="submit" class="btn btn-primary">ğŸ’¾ ActualizeazÄƒ competenÈ›ele</button>
                        {% endif %}
                    </form>
                </div>

                <!-- AdÄƒugarea unei competenÈ›e noi -->
                <div class="add-skill-form">
                    <h4>â• AdaugÄƒ competenÈ›Äƒ nouÄƒ:</h4>
                    <form method="post">
                        <input type="hidden" name="action" value="add_skill">
                        
                        <div style="display: flex; gap: 1rem; align-items: end;">
                            <div style="flex: 1;">
                                <label for="new_skill">Numele competenÈ›ei:</label>
                                <input type="text" id="new_skill" name="new_skill" placeholder="Ex: Node.js & Express" required>
                            </div>
                            <button type="submit" class="btn btn-success">â• AdaugÄƒ</button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="admin-actions">
                <a href="{{ path('jdv_home') }}" class="btn btn-secondary">ğŸ  Vezi pagina</a>
                <a href="{{ path('jdv_logout') }}" class="btn btn-danger">ğŸšª Logout</a>
            </div>

        </div>
    </div>

    <script>
        function deleteSkill(skillId) {
            if (confirm('EÈ™ti sigur cÄƒ vrei sÄƒ È™tergi aceastÄƒ competenÈ›Äƒ?')) {
                fetch(`/jibotean/skill/delete/${skillId}`, {
                    method: 'DELETE',
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest',
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        location.reload();
                    } else {
                        alert('Eroare la È™tergere!');
                    }
                });
            }
        }
    </script>
</body>
</html>